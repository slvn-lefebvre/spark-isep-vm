{
  "paragraphs": [
    {
      "text": "%dep\nz.reset()\nz.addRepo(\"maven central\").url(\"search.maven.org\")\nz.load(\"com.datastax.spark:spark-cassandra-connector_2.10:1.4.1\")",
      "dateUpdated": "Jan 18, 2016 10:29:17 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1449490780713_873949641",
      "id": "20151207-121940_636301644",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "res0: org.apache.zeppelin.spark.dep.Dependency \u003d org.apache.zeppelin.spark.dep.Dependency@7e225715\n"
      },
      "dateCreated": "Dec 7, 2015 12:19:40 PM",
      "dateStarted": "Jan 18, 2016 10:29:17 AM",
      "dateFinished": "Jan 18, 2016 10:29:25 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Load the cassandra-Spark connector library",
      "text": "%spark\nimport com.datastax.spark.connector._\nimport com.datastax.spark.connector.cql._\n",
      "dateUpdated": "Dec 15, 2015 10:40:20 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "editorHide": false,
        "tableHide": false,
        "title": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432590077190_-287242259",
      "id": "20150525-234117_2046828345",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "import com.datastax.spark.connector._\nimport com.datastax.spark.connector.cql._\n"
      },
      "dateCreated": "May 25, 2015 11:41:17 PM",
      "dateStarted": "Dec 15, 2015 10:40:20 AM",
      "dateFinished": "Dec 15, 2015 10:40:28 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n##### Table imports and basic operations\n\nTable import can be done as RDD\u0027s or as Spark SQL/DataFrames.\nWhen done as RDD\u0027s, it\u0027s the developer responsibility to provide the right casting from the CassandraRow type to scala native types.",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "tableHide": false,
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432717763248_640715300",
      "id": "20150527-110923_965931596",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003ch5\u003eTable imports and basic operations\u003c/h5\u003e\n\u003cp\u003eTable import can be done as RDD\u0027s or as Spark SQL/DataFrames.\n\u003cbr  /\u003eWhen done as RDD\u0027s, it\u0027s the developer responsibility to provide the right casting from the CassandraRow type to scala native types.\u003c/p\u003e\n"
      },
      "dateCreated": "May 27, 2015 11:09:23 AM",
      "dateStarted": "Dec 3, 2015 10:48:29 PM",
      "dateFinished": "Dec 3, 2015 10:48:30 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Table imports",
      "text": "val checkins \u003d sc.cassandraTable(\"lbsn\", \"checkins\")\nval venues   \u003d sc.cassandraTable(\"lbsn\", \"venues\")",
      "dateUpdated": "Dec 15, 2015 10:42:18 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "tableHide": false,
        "editorHide": false,
        "title": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432717561518_825132093",
      "id": "20150527-110601_1586240884",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "checkins: com.datastax.spark.connector.rdd.CassandraTableScanRDD[com.datastax.spark.connector.CassandraRow] \u003d CassandraTableScanRDD[0] at RDD at CassandraRDD.scala:15\nvenues: com.datastax.spark.connector.rdd.CassandraTableScanRDD[com.datastax.spark.connector.CassandraRow] \u003d CassandraTableScanRDD[1] at RDD at CassandraRDD.scala:15\n"
      },
      "dateCreated": "May 27, 2015 11:06:01 AM",
      "dateStarted": "Dec 15, 2015 10:42:18 AM",
      "dateFinished": "Dec 15, 2015 10:42:19 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Checkins",
      "text": "checkins.count()\ncheckins.first()",
      "dateUpdated": "Dec 15, 2015 10:42:39 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432718133099_-947206352",
      "id": "20150527-111533_1525954664",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "res3: Long \u003d 138449\nres4: com.datastax.spark.connector.CassandraRow \u003d CassandraRow{year: 2010, month: 9, day: 1, time: 196, uid: 92271, lat: 40.727941607, lon: -74.001798235, ts: 2010-09-01 00:03:16+0000, vid: 2215327}\n"
      },
      "dateCreated": "May 27, 2015 11:15:33 AM",
      "dateStarted": "Dec 15, 2015 10:42:39 AM",
      "dateFinished": "Dec 15, 2015 10:42:48 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Venues",
      "text": "venues.count()\nvenues.first()",
      "dateUpdated": "Dec 7, 2015 12:34:35 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432718144890_1975361617",
      "id": "20150527-111544_1952100840",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "res15: Long \u003d 28699\nres16: com.datastax.spark.connector.CassandraRow \u003d CassandraRow{vid: 1204811, lat: 40.58278675, lon: -73.9534122667, name: Holocaust memorial park}\n"
      },
      "dateCreated": "May 27, 2015 11:15:44 AM",
      "dateStarted": "Dec 7, 2015 12:34:35 PM",
      "dateFinished": "Dec 7, 2015 12:34:36 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Query the collection using the cassandraRow API",
      "text": "%md\nThe where clause translates back into cql, therefore it would allow selection on partition key and range on clustering key.",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "tableHide": false,
        "editorHide": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432719793919_-1724471938",
      "id": "20150527-114313_1667897903",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cp\u003eThe where clause translates back into cql, therefore it would allow selection on partition key and range on clustering key.\u003c/p\u003e\n"
      },
      "dateCreated": "May 27, 2015 11:43:13 AM",
      "dateStarted": "Jul 9, 2015 12:03:39 AM",
      "dateFinished": "Jul 9, 2015 12:03:39 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Time range Query",
      "text": "// how many checkins in new york during the valentine weekend\n\ncheckins.where(\"year \u003d 2010 and month\u003d2 and day\u003e12 and day\u003c15\").count()",
      "dateUpdated": "Dec 9, 2015 4:34:29 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432719434247_174787671",
      "id": "20150527-113714_1109272181",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "res14: Long \u003d 887\n"
      },
      "dateCreated": "May 27, 2015 11:37:14 AM",
      "dateStarted": "Dec 9, 2015 4:34:29 PM",
      "dateFinished": "Dec 9, 2015 4:34:32 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Where is Central Park?",
      "text": "venues.where(\"vid \u003d 7239827\").first()\n",
      "dateUpdated": "Dec 7, 2015 12:34:50 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432718256017_1333736725",
      "id": "20150527-111736_491790695",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "res22: com.datastax.spark.connector.CassandraRow \u003d CassandraRow{vid: 7239827, lat: 40.758265613, lon: -73.994356727, name: Central Park Manhattan }\n"
      },
      "dateCreated": "May 27, 2015 11:17:36 AM",
      "dateStarted": "Dec 7, 2015 12:34:50 PM",
      "dateFinished": "Dec 7, 2015 12:34:50 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Column selection",
      "text": "venues.select(\"vid\", \"name\").take(10).foreach(println)\n",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432719916428_1753273370",
      "id": "20150527-114516_2133677116",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "CassandraRow{vid: 754108, name: My Suit NY }\nCassandraRow{vid: 249755, name: UA Court Street Stadium 12}\nCassandraRow{vid: 6919688, name: Nasty London!}\nCassandraRow{vid: 521775, name: Calico Jacks Cantina}\nCassandraRow{vid: 866136, name: Pho Bac}\nCassandraRow{vid: 3841997, name: cave of the ridiculous}\nCassandraRow{vid: 246266, name: Sky Asian Bistro}\nCassandraRow{vid: 6762177, name: All Star Car Wash}\nCassandraRow{vid: 797962, name: Blush}\nCassandraRow{vid: 535067, name: Thompson Lower East Side}\n"
      },
      "dateCreated": "May 27, 2015 11:45:16 AM",
      "dateStarted": "Jul 9, 2015 12:19:13 AM",
      "dateFinished": "Jul 9, 2015 12:19:15 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n##### Converting to native scala types, for instance tuples\nThe CassandraTable produces an RDD of type CassandraRow. If you want to move away from the CassandraRow type you can map to other types, using the usual spark transformations (map, reduce, flatmap, etc.)",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "tableHide": false,
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432719986904_866502131",
      "id": "20150527-114626_1437072784",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003ch5\u003eConverting to native scala types, for instance tuples\u003c/h5\u003e\n\u003cp\u003eThe CassandraTable produces an RDD of type CassandraRow. If you want to move away from the CassandraRow type you can map to other types, using the usual spark transformations (map, reduce, flatmap, etc.)\u003c/p\u003e\n"
      },
      "dateCreated": "May 27, 2015 11:46:26 AM",
      "dateStarted": "Jun 18, 2015 10:16:02 AM",
      "dateFinished": "Jun 18, 2015 10:16:02 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Who checked in Soho?",
      "text": "// soho bounding box: -74.0055, 40.7187, -73.9959, 40.7296\n\n// from CassandraRow to scala Tuples\n\nval coords \u003d checkins.map(row \u003d\u003e (row.getDouble(\"lat\"), row.getDouble(\"lon\")))\n\ncoords.\n  filter(coord \u003d\u003e coord._1 \u003e 40.7187 \u0026 coord._1 \u003c 40.7296).\n  filter(coord \u003d\u003e coord._2 \u003e -74.0055 \u0026 coord._2 \u003c -73.9959).\n  count()",
      "dateUpdated": "Dec 9, 2015 4:35:35 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432718398874_-1156926795",
      "id": "20150527-111958_961707599",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "coords: org.apache.spark.rdd.RDD[(Double, Double)] \u003d MapPartitionsRDD[11] at map at \u003cconsole\u003e:41\nres21: Long \u003d 5135\n"
      },
      "dateCreated": "May 27, 2015 11:19:58 AM",
      "dateStarted": "Dec 9, 2015 4:35:35 PM",
      "dateFinished": "Dec 9, 2015 4:35:40 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "filtering on Columns, Map to Tuples",
      "text": "// from CassandraRow to some other object\n\n// via cassandraRow methods\nvenues.select(\"vid\", \"name\").map(row \u003d\u003e (row.getLong(\"vid\"), row.getString(\"name\"))).take(10).foreach(println)\n",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432720278250_1572930116",
      "id": "20150527-115118_1723421919",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": ""
      },
      "dateCreated": "May 27, 2015 11:51:18 AM",
      "dateStarted": "Dec 3, 2015 4:44:17 PM",
      "dateFinished": "Dec 3, 2015 4:44:19 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Filtering on columns, Map to case class",
      "text": "// by defining a case class\ncase class Venue(vid: Long, name: String)\nsc.cassandraTable[Venue](\"lbsn\", \"venues\").take(10).foreach(println)",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432720481426_2121306212",
      "id": "20150527-115441_1429307717",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "defined class Venue\nVenue(1162492,Hillary Flowers)\nVenue(1165309,Roadside Entertainment)\nVenue(703772,Pan Aqua)\nVenue(396792,O\u0027Reilly\u0027s Pub)\nVenue(447153,Kam Wei Kitchen)\nVenue(7558564,SouthWestNY)\nVenue(7410669,Windsor Hotel)\nVenue(6856641,New Rochelle High School)\nVenue(267286,US Flag Plaza, Liberty Park, NJ)\nVenue(262669,Galloway Castle)\n"
      },
      "dateCreated": "May 27, 2015 11:54:41 AM",
      "dateStarted": "Jun 18, 2015 10:16:15 AM",
      "dateFinished": "Jun 18, 2015 10:16:17 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n##### SQL schema extraction with Spark SQL\nBy using the CassandraSQLContext, the schema is extracted from a sample of the read data. Therefore no explicit casting/mapping is required, and you can move faster to standard scala native types.",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432720763673_2141326834",
      "id": "20150527-115923_713657747",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003ch5\u003eSQL schema extraction with Spark SQL\u003c/h5\u003e\n\u003cp\u003eBy using the CassandraSQLContext, the schema is extracted from a sample of the read data. Therefore no explicit casting/mapping is required, and you can move faster to standard scala native types.\u003c/p\u003e\n"
      },
      "dateCreated": "May 27, 2015 11:59:23 AM",
      "dateStarted": "Jun 18, 2015 10:16:02 AM",
      "dateFinished": "Jun 18, 2015 10:16:02 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Table import with Spark SQL/DataFrame",
      "text": "// by converting to a spark sql/dataframe\nimport org.apache.spark.sql.cassandra.CassandraSQLContext\nval cc \u003d new CassandraSQLContext(sc)\nval df_venues \u003d cc.sql(\"select vid, name from lbsn.venues\")\n",
      "dateUpdated": "Dec 9, 2015 4:36:43 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432720642159_-167936064",
      "id": "20150527-115722_1084797803",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "import org.apache.spark.sql.cassandra.CassandraSQLContext\ncc: org.apache.spark.sql.cassandra.CassandraSQLContext \u003d org.apache.spark.sql.cassandra.CassandraSQLContext@651ac89\ndf_venues: org.apache.spark.sql.DataFrame \u003d [vid: bigint, name: string]\n"
      },
      "dateCreated": "May 27, 2015 11:57:22 AM",
      "dateStarted": "Dec 9, 2015 4:36:43 PM",
      "dateFinished": "Dec 9, 2015 4:36:44 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "df_venues.show(10)",
      "dateUpdated": "Dec 7, 2015 12:35:22 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432590189646_-302446680",
      "id": "20150525-234309_208755663",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "+-------+--------------------+\n|    vid|                name|\n+-------+--------------------+\n|1204811|Holocaust memoria...|\n|7297320|           Taxi 9V81|\n|7539957|             Sephora|\n| 119295|        Theatreworks|\n| 542538|             Staples|\n|1025212|              Taksim|\n|3930791|    Rocco\u0027s Calamari|\n|6919027|         Kung Fu Tea|\n|1274015|   Cake \u0026 Shake Cart|\n| 439266|European Day Spa ...|\n+-------+--------------------+\n\n"
      },
      "dateCreated": "May 25, 2015 11:43:09 PM",
      "dateStarted": "Dec 7, 2015 12:35:22 PM",
      "dateFinished": "Dec 7, 2015 12:35:23 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n##### Cassandra-side vs Spark-side Filtering\n\nWhen the query is compatible with cql filtering and selection is executed fully on the cassandra side. By using the CassandraSQL context you can also define a query which would require also some filtering on the spark side.",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432721218517_-1572445217",
      "id": "20150527-120658_1608038810",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003ch5\u003eCassandra-side vs Spark-side Filtering\u003c/h5\u003e\n\u003cp\u003eWhen the query is compatible with cql filtering and selection is executed fully on the cassandra side. By using the CassandraSQL context you can also define a query which would require also some filtering on the spark side.\u003c/p\u003e\n"
      },
      "dateCreated": "May 27, 2015 12:06:58 PM",
      "dateStarted": "Jun 18, 2015 10:16:02 AM",
      "dateFinished": "Jun 18, 2015 10:16:02 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Cassandra-side filtering",
      "text": "// as RDD of CassandraRows\nval checkins \u003d sc.cassandraTable(\"lbsn\", \"checkins\").select(\"ts\", \"uid\", \"vid\").where(\"year\u003d2010 and month\u003d9 and day\u003c16 and day\u003e13\")\ncheckins.take(10).foreach(println)\n\n// as a SchemaRDD\nval checkins \u003d cc.sql(\"select ts, uid, vid from lbsn.checkins where year\u003d2010 and month\u003d9 and day\u003c16 and day\u003e13\")\ncheckins.show(10)\n",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432721000835_598617850",
      "id": "20150527-120320_104479665",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "checkins: com.datastax.spark.connector.rdd.CassandraTableScanRDD[com.datastax.spark.connector.CassandraRow] \u003d CassandraTableScanRDD[17] at RDD at CassandraRDD.scala:15\nCassandraRow{ts: 2010-09-14 02:01:31+0200, uid: 853, vid: 917955}\nCassandraRow{ts: 2010-09-14 02:05:28+0200, uid: 4516, vid: 37160}\nCassandraRow{ts: 2010-09-14 02:05:44+0200, uid: 2964, vid: 956870}\nCassandraRow{ts: 2010-09-14 02:05:59+0200, uid: 48555, vid: 3026508}\nCassandraRow{ts: 2010-09-14 02:11:28+0200, uid: 189786, vid: 1036251}\nCassandraRow{ts: 2010-09-14 02:14:33+0200, uid: 33841, vid: 1502210}\nCassandraRow{ts: 2010-09-14 02:16:07+0200, uid: 12719, vid: 1078872}\nCassandraRow{ts: 2010-09-14 02:18:17+0200, uid: 105012, vid: 341495}\nCassandraRow{ts: 2010-09-14 02:19:24+0200, uid: 1214, vid: 1205097}\nCassandraRow{ts: 2010-09-14 02:22:20+0200, uid: 189786, vid: 541535}\ncheckins: org.apache.spark.sql.DataFrame \u003d [ts: timestamp, uid: bigint, vid: bigint]\nts                   uid    vid    \n2010-09-14 02:01:... 853    917955 \n2010-09-14 02:05:... 4516   37160  \n2010-09-14 02:05:... 2964   956870 \n2010-09-14 02:05:... 48555  3026508\n2010-09-14 02:11:... 189786 1036251\n2010-09-14 02:14:... 33841  1502210\n2010-09-14 02:16:... 12719  1078872\n2010-09-14 02:18:... 105012 341495 \n2010-09-14 02:19:... 1214   1205097\n2010-09-14 02:22:... 189786 541535 \n"
      },
      "dateCreated": "May 27, 2015 12:03:20 PM",
      "dateStarted": "Jul 9, 2015 12:20:23 AM",
      "dateFinished": "Jul 9, 2015 12:20:26 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Spark-side filtering",
      "text": "val checkins \u003d cc.sql(\"select ts, uid, vid from lbsn.checkins where day\u003c16 and day\u003e13\")\ncheckins.show(10)",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432721631697_623698216",
      "id": "20150527-121351_1525574369",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "checkins: org.apache.spark.sql.DataFrame \u003d [ts: timestamp, uid: bigint, vid: bigint]\nts                   uid   vid   \n2009-11-14 00:00:... 3480  98902 \n2009-11-14 00:14:... 4890  98940 \n2009-11-14 00:30:... 4792  51622 \n2009-11-14 00:30:... 24977 98881 \n2009-11-14 00:35:... 222   11844 \n2009-11-14 00:48:... 22    99038 \n2009-11-14 00:50:... 22    86144 \n2009-11-14 01:07:... 29073 55555 \n2009-11-14 01:16:... 4850  99122 \n2009-11-14 01:42:... 2105  623366\n"
      },
      "dateCreated": "May 27, 2015 12:13:51 PM",
      "dateStarted": "Dec 3, 2015 4:46:01 PM",
      "dateFinished": "Dec 3, 2015 4:46:02 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Combined Cassandra-side \u0026 Spark-side filtering",
      "text": "val checkins \u003d cc.sql(\"select ts, uid, vid from lbsn.checkins where year\u003d2010 and month\u003d9 and vid\u003d57871\")\ncheckins.show(10)",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432721712577_1166902366",
      "id": "20150527-121512_1013813562",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "checkins: org.apache.spark.sql.DataFrame \u003d [ts: timestamp, uid: bigint, vid: bigint]\nts                   uid  vid  \n2010-09-30 23:57:... 1684 57871\n"
      },
      "dateCreated": "May 27, 2015 12:15:12 PM",
      "dateStarted": "Dec 3, 2015 4:45:54 PM",
      "dateFinished": "Dec 3, 2015 4:45:55 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Joining cassandra tables in Spark",
      "text": "// joining tables (the easy way, and just as fast)\n\nval df_venues   \u003d cc.sql(\"select vid, name from lbsn.venues\").as(\"venues\").cache()\nval df_checkins \u003d cc.sql(\"select ts, uid, lat, lon, vid from lbsn.checkins\").as(\"checkins\").cache()\n\nval checkins_venues \u003d df_checkins.join(df_venues, $\"checkins.vid\" \u003d\u003d\u003d $\"venues.vid\", \"inner\").select(\"ts\", \"uid\", \"lat\", \"lon\", \"checkins.vid\",\"name\")\n\nprintln(\"%table\")\nprintln(\"ts\\t uid \\t lat \\t lon \\t vid \\t name\")\nprintln(checkins_venues.limit(10).map( s \u003d\u003e s.mkString(\"\\t\")).collect().mkString(\"\\n\"))\n\n//printl(\"%table\")\n//println(\"ts\\t uid \\t lat \\t lon \\t vid \\t name \\n\")\n//println(checkins_venues.limit(10).map(s \u003d\u003e s.mkString(\"\\t\")).collect())",
      "dateUpdated": "Dec 9, 2015 4:37:05 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": true,
          "keys": [
            {
              "name": "ts",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": " uid ",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": " lat ",
              "index": 2.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": " lon ",
              "index": 3.0,
              "aggr": "sum"
            }
          }
        },
        "title": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432590425203_-293290972",
      "id": "20150525-234705_2017691418",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "ts\t uid \t lat \t lon \t vid \t name\n2010-07-01 00:47:47.0\t578\t40.7490532543\t-73.9680397511\t11831\tUnited Nations\n2010-07-02 16:27:53.0\t991\t40.7188502243\t-73.99594579149999\t818431\tOK 218\n2010-07-03 00:07:38.0\t34359\t40.7348441565\t-73.9995288849\t123831\tKingswood\n2010-07-03 16:58:19.0\t578\t40.6838680433\t-73.9786720276\t105831\tPacific Street Station\n2010-07-03 17:53:28.0\t2737\t40.6906938667\t-73.9956976167\t197431\tFloyd, NY\n2010-07-03 21:11:13.0\t49393\t40.6997066969\t-73.8085234165\t28031\tJamaica LIRR Station\n2010-07-04 01:40:29.0\t119601\t40.7490532543\t-73.9680397511\t11831\tUnited Nations\n2010-07-05 04:49:02.0\t128772\t40.8344876113\t-73.9385139942\t1241631\tMorris Jumel Mansion\n2010-07-06 05:36:57.0\t38706\t40.7490532543\t-73.9680397511\t11831\tUnited Nations\n2010-07-06 15:12:46.0\t35105\t40.6997066969\t-73.8085234165\t28031\tJamaica LIRR Station\n"
      },
      "dateCreated": "May 25, 2015 11:47:05 PM",
      "dateStarted": "Dec 9, 2015 4:37:05 PM",
      "dateFinished": "Dec 9, 2015 4:37:16 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Aggregate and group by",
      "text": "// top 10 checked in venues\nprintln(\"%table\")\nprintln(\"Venue \\t Count\\n\")\nprintln(checkins_venues.groupBy(\"name\").count().sort($\"count\".desc).limit(12).map( s \u003d\u003e s.mkString(\"\\t\")).collect().mkString(\"\\n\"))",
      "dateUpdated": "Dec 9, 2015 3:08:38 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "multiBarChart",
          "height": 300.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "Venue ",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": " Count",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "Venue ",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": " Count",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432590556428_-1134585219",
      "id": "20150525-234916_2129265918",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "Venue \t Count\n\nLGA LaGuardia Airport\t1673\nJFK John F. Kennedy International\t1643\nStarbucks\t1316\nStarbucks Coffee\t1114\nTimes Square\t1084\nEWR Newark Liberty International\t1084\nGrand Central Terminal\t1002\nDunkin\u0027 Donuts\t507\nMadison Square Garden\t426\nThe Museum of Modern Art (MoMA)\t392\nEmpire State Building\t389\nShake Shack\t377\n"
      },
      "dateCreated": "May 25, 2015 11:49:16 PM",
      "dateStarted": "Dec 9, 2015 3:07:00 PM",
      "dateFinished": "Dec 9, 2015 3:07:02 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Machine Learning: k-means Clustering",
      "text": "// run k-means clustering on the data\n\nimport org.apache.spark.mllib.clustering.KMeans\nimport org.apache.spark.mllib.linalg.Vectors\n\nval locs \u003d checkins_venues.select(\"lat\",\"lon\").map(s \u003d\u003e Vectors.dense(s.getDouble(0), s.getDouble(1))).cache()\nlocs.first()\n\nval numClusters \u003d 50\nval numIterations \u003d 20\nval clusters \u003d KMeans.train(locs, numClusters, numIterations)\n\nprintln()\n\nval WSSSE \u003d clusters.computeCost(locs)\nprintln(\"Within Set Sum of Squared Errors \u003d \" + WSSSE + \"\\n\")\n\nclusters.clusterCenters.foreach(println)\n",
      "dateUpdated": "Dec 9, 2015 4:40:27 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432799823040_-122604534",
      "id": "20150528-095703_1809695413",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "import org.apache.spark.mllib.clustering.KMeans\nimport org.apache.spark.mllib.linalg.Vectors\nlocs: org.apache.spark.rdd.RDD[org.apache.spark.mllib.linalg.Vector] \u003d MapPartitionsRDD[43] at map at \u003cconsole\u003e:47\nres40: org.apache.spark.mllib.linalg.Vector \u003d [40.727941607,-74.001798235]\nnumClusters: Int \u003d 50\nnumIterations: Int \u003d 20\nclusters: org.apache.spark.mllib.clustering.KMeansModel \u003d org.apache.spark.mllib.clustering.KMeansModel@1ed90b98\n\nWSSSE: Double \u003d 11.793571261081304\nWithin Set Sum of Squared Errors \u003d 11.793571261081304\n\n[40.76571421152616,-73.9827481391053]\n[40.58942306234566,-73.81737277941235]\n[40.90654545171361,-74.0504035103978]\n[40.652664243663644,-73.89029242260561]\n[40.723959875293296,-73.95130203264824]\n[40.772077890208045,-73.87245387661204]\n[40.69121306255072,-74.04479566193694]\n[40.634048908998146,-74.10259806808857]\n[40.709471263133885,-74.01121255689426]\n[40.744309771640985,-73.84442828379858]\n[40.73969999709834,-74.16752753593082]\n[40.82620887068213,-73.82111842095131]\n[40.58772013025493,-74.1597976743969]\n[40.687480107995455,-73.9947091867982]\n[40.75733248694232,-73.9178891934415]\n[40.78465796180355,-74.0430243454]\n[40.813180045352446,-74.21943600049605]\n[40.827394233851315,-73.930709865704]\n[40.77340673164533,-73.95475406640445]\n[40.58016684675408,-73.974671934083]\n[40.801383286909626,-73.94088537913748]\n[40.89958391102281,-74.15307117107075]\n[40.90474758694384,-73.7976718784798]\n[40.827043274441706,-74.00747932845428]\n[40.62489634810242,-74.02379769902639]\n[40.649613445225334,-74.23657501067133]\n[40.72698169107213,-73.79302092719031]\n[40.73922038321919,-74.0034456478161]\n[40.72675097580042,-73.98819514843959]\n[40.69061587568747,-74.17933041085233]\n[40.74002118908606,-74.03053367959089]\n[40.86291179893909,-73.89440348350904]\n[40.67008127709481,-73.96277916228536]\n[40.890552697569895,-74.23993892886989]\n[40.75646623392193,-73.9741286914704]\n[40.84300266561956,-74.16952898816369]\n[40.7238533457686,-74.00050750317385]\n[40.761094276155795,-74.00187133733588]\n[40.826257990991365,-74.08619366503272]\n[40.814071378928645,-74.14177652997623]\n[40.52977201513426,-74.22923107161759]\n[40.74104775241008,-73.98812501806391]\n[40.751686993246196,-74.07796678232533]\n[40.67263624040853,-73.98180807802534]\n[40.81009722567018,-73.96099549302369]\n[40.853829002839845,-73.94370265605244]\n[40.64550208478889,-73.78416920494598]\n[40.72310257058765,-74.04300200051512]\n[40.754352987851625,-73.98826930956301]\n[40.699734452374386,-73.92493910531729]\n"
      },
      "dateCreated": "May 28, 2015 9:57:03 AM",
      "dateStarted": "Dec 9, 2015 4:40:27 PM",
      "dateFinished": "Dec 9, 2015 4:40:38 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Machine Learning: Score predictions",
      "text": "\nimport org.apache.spark.sql.functions.udf\n\nval func \u003d (lat:Double, lon:Double) \u003d\u003e clusters.predict(Vectors.dense(lat,lon))\nval sqlfunc \u003d udf(func)\n\n// add predictions as extra column, by using a user define function\n// remember that clusters closes over the udf, and is broadcasted to the various executors\nval locs_cid \u003d checkins_venues.withColumn(\"cluster\", sqlfunc(checkins_venues(\"lat\"), checkins_venues(\"lon\")))\n\nlocs_cid.show(10)\n",
      "dateUpdated": "Dec 9, 2015 4:41:58 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432812324451_1990364296",
      "id": "20150528-132524_1901310525",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "import org.apache.spark.sql.functions.udf\nfunc: (Double, Double) \u003d\u003e Int \u003d \u003cfunction2\u003e\nsqlfunc: org.apache.spark.sql.UserDefinedFunction \u003d UserDefinedFunction(\u003cfunction2\u003e,IntegerType)\nlocs_cid: org.apache.spark.sql.DataFrame \u003d [ts: timestamp, uid: bigint, lat: double, lon: double, vid: bigint, name: string, cluster: int]\n+--------------------+------+------------------+--------------+-------+--------------------+-------+\n|                  ts|   uid|               lat|           lon|    vid|                name|cluster|\n+--------------------+------+------------------+--------------+-------+--------------------+-------+\n|2010-09-01 00:03:...| 92271|      40.727941607| -74.001798235|2215327|             Na Thai|     36|\n|2010-09-01 00:05:...| 18974|      40.763625933| -74.001058517|1542433|             Pier 84|     37|\n|2010-09-01 00:06:...|  4576|     40.7326839167|  -73.92515105| 395620|   Kosciuszko Bridge|     14|\n|2010-09-01 00:07:...| 10528|     40.7230030099|-73.9890840986|  83203|             Maconda|     28|\n|2010-09-01 00:09:...| 12617|     40.7145733585|-73.9910136841| 120962|         Clandestino|     28|\n|2010-09-01 00:13:...|174103|       40.83869855|   -74.1543578| 744537|Stew Leonard\u0027s Wi...|     35|\n|2010-09-01 00:13:...|   336|40.726115066700004|-73.9834805833| 100867|                  7A|     28|\n|2010-09-01 00:14:...|112956|       40.82408607|  -74.09831649|1399147|Castle Billiards ...|     38|\n|2010-09-01 00:14:...|119325|     40.7578308137|-73.9860856533|  48512|    Best Buy Theater|     48|\n|2010-09-01 00:16:...| 11372|40.732433783299996|-74.0031981333|  80808|                Fish|     27|\n+--------------------+------+------------------+--------------+-------+--------------------+-------+\n\n"
      },
      "dateCreated": "May 28, 2015 1:25:24 PM",
      "dateStarted": "Dec 9, 2015 4:41:58 PM",
      "dateFinished": "Dec 9, 2015 4:42:00 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val df \u003d locs_cid.select(\"cluster\", \"name\").\n    groupBy(\"cluster\", \"name\").\n    agg(Map(\"name\" -\u003e \"count\")).\n    sort($\"cluster\", $\"COUNT(name)\".desc).cache()\n    \ndf.show()    \n    \n",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432819281971_1801397794",
      "id": "20150528-152121_1489205140",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "df: org.apache.spark.sql.DataFrame \u003d [cluster: int, name: string, COUNT(name): bigint]\ncluster name                 COUNT(name)\n0       Starbucks Coffee     172        \n0       Regal Union Squar... 118        \n0       Whole Foods Marke... 95         \n0       AOL HQ               92         \n0       Strand Bookstore     85         \n0       Katz\u0027s Delicatessen  79         \n0       Ippudo               73         \n0       Trader Joe\u0027s         70         \n0       Momofuku Noodle Bar  66         \n0       Whole Foods Marke... 62         \n0       The Grey Dog\u0027s Co... 59         \n0       Webster Hall         58         \n0       Momofuku Milk Bar    58         \n0       Veselka              55         \n0       Schiller\u0027s Liquor... 54         \n0       Think Coffee         53         \n0       Foursquare HQ        52         \n0       Astor Place Station  50         \n0       Momofuku Ssäm Bar    48         \n0       Max Brenner          48         \n"
      },
      "dateCreated": "May 28, 2015 3:21:21 PM",
      "dateStarted": "Jul 9, 2015 12:23:13 AM",
      "dateFinished": "Jul 9, 2015 12:23:52 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// from fd to rdd\nval r \u003d df.rdd.map(row \u003d\u003e (row.getInt(0), (row.getString(1), row.getLong(2))) ).cache()\n\nr.first",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1434450862357_-1462192328",
      "id": "20150616-123422_2132697783",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "r: org.apache.spark.rdd.RDD[(Int, (String, Long))] \u003d MapPartitionsRDD[164] at map at \u003cconsole\u003e:58\nres67: (Int, (String, Long)) \u003d (0,(Starbucks Coffee,172))\n"
      },
      "dateCreated": "Jun 16, 2015 12:34:22 PM",
      "dateStarted": "Jul 9, 2015 12:23:57 AM",
      "dateFinished": "Jul 9, 2015 12:24:24 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val topNPerGroup \u003d r.groupByKey.map { \n   case (k, v) \u003d\u003e \n       k -\u003e v.toList.sortBy(-_._2).take(3)\n}\n\ntopNPerGroup.collect.foreach(println)",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1434454009943_131618446",
      "id": "20150616-132649_590619108",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "topNPerGroup: org.apache.spark.rdd.RDD[(Int, List[(String, Long)])] \u003d MapPartitionsRDD[166] at map at \u003cconsole\u003e:59\n(0,List((Starbucks Coffee,172), (Regal Union Square Stadium 14,118), (Whole Foods Market (Union Square),95)))\n(1,List((Nuno\u0027s Pavillion,48), (Elizabeth Train Station,19), (Quick Check,17)))\n(2,List((Starbucks,249), (Radio City Music Hall,237), (Columbus Circle,174)))\n(3,List((JFK John F. Kennedy International,1643), (JFK Terminal 5,325), (Terminal 4 at JFK,115)))\n(4,List((Columbia University,110), (The City College Of New York - NAC Building,58), (Harlem—125th Street Metro North Station,49)))\n(5,List((EWR Newark Liberty International,1084), (EWR Terminal A,167), (EWR Terminal C,162)))\n(6,List((Throgs Neck Bridge Toll,117), (Throgs Neck Bridge,86), (Whitestone Bridge,25)))\n(7,List((RHM Headquarters,36), (Egan\u0027s,22), (Edgemont Memorial Park,18)))\n(8,List((Dunkin\u0027 Donuts,88), (Verrazano-Narrows Bridge,77), (New York Sports Club ,59)))\n(9,List((Queensboro Plaza Station,51), (Bohemian Hall \u0026 Beer Garden,36), (Studio Square Beer Garden,31)))\n(10,List((Secaucus Junction,113), (Xchange,16), (Starbucks,15)))\n(11,List((Trader Joe\u0027s,69), (IKEA,62), (Starbucks Coffee,54)))\n(12,List((LIRR Bayside Station,24), (Chino Rican Tattoo \u0026 Body Art,24), (Clearview Expressway,21)))\n(13,List((Citi Field,156), (Arthur Ashe Stadium,57), (Billie Jean King National Tennis Center,30)))\n(14,List((Mitsuwa Marketplace,33), (Vince Lombardi Service Area,24), (Panera Bread,14)))\n(15,List((Starbucks,27), (AMC Clifton Commons 16,20), (Signature Fitness,18)))\n(16,List((Apple Store, West 14th Street,252), (The High Line,207), (The Chelsea Market,171)))\n(17,List((Holland Tunnel,144), (Starbucks,89), (Hoboken Terminal,55)))\n(18,List((Starbucks #07897,34), (Kingdom of Legions and Ninjas,17), (Fruit Ranch,16)))\n(19,List((Times Square,1084), (Madison Square Garden,426), (Bryant Park,363)))\n(20,List((South Mountain Yoga,16), (Seton Hall University,9), (McDonald\u0027s,4)))\n(21,List((Myrtle—Wycoff Avenues Station,41), (Roberta\u0027s,28), (292 Park,19)))\n(22,List((Newark Penn Station,234), (Redwood Hall,51), (Prudential Center,49)))\n(23,List((Bronx VA Hospital,35), (The Cloisters,30), (2020 Grand Ave,28)))\n(24,List((New Rochelle Station,21), (Pelham Metro-North Station,12), (X Haus,11)))\n(25,List((Brooklyn Bowl,80), (The Bagel Store,55), (McCarren Park,54)))\n(26,List((Staten Island Ferry,97), (Middle Of The Harbor,19), (Richmond County Bank Ballpark,11)))\n(27,List((Bay Plaza,27), (Pelham Bay Park,24), (3555 Bruckner Blvd,16)))\n(28,List((Garden State Plaza,65), (AMC Garden State 16,27), (Apple Store, Paramus,25)))\n(29,List((Apple Store, Staten Island,54), (Staten Island Mall,23), (Starbucks,8)))\n(30,List((The Bronx Zoo,45), (New York Botanical Garden,25), (Fordham Metro-North Station,19)))\n(31,List((Hillcrest Firehouse: PFD,15), (La Ziza,12), (Old Roberto Clemente,12)))\n(32,List((New Meadowlands Stadium,66), (Izod Center,32), (Station Square,27)))\n(33,List((Apple Store, SoHo,223), (Starbucks Coffee,216), (VaynerMedia HQ,211)))\n(34,List((Milk Bar,62), (Bagel World,58), (Union Street Station,54)))\n(35,List((Grand Central Terminal,1002), (The Museum of Modern Art (MoMA),392), (Rockefeller Center,353)))\n(36,List((LGA LaGuardia Airport,1673), (Terminal C at LGA,131), (LGA Marine Air Terminal,63)))\n(37,List((Statue of Liberty,124), (Journal Square PATH Station,79), (Ellis Island,44)))\n(38,List((Starbucks,176), (Carlos And Kelseys Place,65), (Whitney Museum of Art,64)))\n(39,List((Staten Island Zoo,19), (Burrito Bar,19), (Starbucks Coffee,17)))\n(40,List((Target,12), (Home Sweet Home,12), (Kings Plaza,8)))\n(41,List((Queens Center Mall,25), (61st Street—Woodside Station,24), (SriPraPhai,22)))\n(42,List((Retro Fitness,57), (Riverside Square Mall,23), (Bergen County Academies,13)))\n(43,List((Target,21), (Applebee\u0027s,10), (Cheeburger Cheeburger,8)))\n(44,List((Yankee Stadium,370), (George Washington Bridge,184), (625 W 156 Street,64)))\n(45,List((World Trade Center (Ground Zero),165), (Battery Park,132), (Starbucks Coffee,130)))\n(46,List((Coney Island Boardwalk,71), (Nathan\u0027s Famous Frankfurters,53), (New York Aquarium,22)))\n(47,List((Empire State Building,389), (Union Square,333), (Ace Hotel,277)))\n(48,List((Jamaica LIRR Station,124), (Jamaica Airtrain,26), (DEP 24,13)))\n(49,List((MTA Beach 67 St [A],19), (Beach 67th,11), (Delta Sky Club,10)))\n"
      },
      "dateCreated": "Jun 16, 2015 1:26:49 PM",
      "dateStarted": "Jul 9, 2015 12:24:48 AM",
      "dateFinished": "Jul 9, 2015 12:25:17 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// flattening this to a single list\nval flattenedTopNPerGroup \u003d \n    topNPerGroup.flatMap({case (k,v) \u003d\u003e v.map(s \u003d\u003e (k,s))})\n\nflattenedTopNPerGroup.collect.foreach(println)",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1434454903370_-417007247",
      "id": "20150616-134143_374297113",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "flattenedTopNPerGroup: org.apache.spark.rdd.RDD[(Int, (String, Long))] \u003d MapPartitionsRDD[167] at flatMap at \u003cconsole\u003e:63\n(0,(Starbucks Coffee,172))\n(0,(Regal Union Square Stadium 14,118))\n(0,(Whole Foods Market (Union Square),95))\n(1,(Nuno\u0027s Pavillion,48))\n(1,(Elizabeth Train Station,19))\n(1,(Quick Check,17))\n(2,(Starbucks,249))\n(2,(Radio City Music Hall,237))\n(2,(Columbus Circle,174))\n(3,(JFK John F. Kennedy International,1643))\n(3,(JFK Terminal 5,325))\n(3,(Terminal 4 at JFK,115))\n(4,(Columbia University,110))\n(4,(The City College Of New York - NAC Building,58))\n(4,(Harlem—125th Street Metro North Station,49))\n(5,(EWR Newark Liberty International,1084))\n(5,(EWR Terminal A,167))\n(5,(EWR Terminal C,162))\n(6,(Throgs Neck Bridge Toll,117))\n(6,(Throgs Neck Bridge,86))\n(6,(Whitestone Bridge,25))\n(7,(RHM Headquarters,36))\n(7,(Egan\u0027s,22))\n(7,(Edgemont Memorial Park,18))\n(8,(Dunkin\u0027 Donuts,88))\n(8,(Verrazano-Narrows Bridge,77))\n(8,(New York Sports Club ,59))\n(9,(Queensboro Plaza Station,51))\n(9,(Bohemian Hall \u0026 Beer Garden,36))\n(9,(Studio Square Beer Garden,31))\n(10,(Secaucus Junction,113))\n(10,(Xchange,16))\n(10,(Starbucks,15))\n(11,(Trader Joe\u0027s,69))\n(11,(IKEA,62))\n(11,(Starbucks Coffee,54))\n(12,(LIRR Bayside Station,24))\n(12,(Chino Rican Tattoo \u0026 Body Art,24))\n(12,(Clearview Expressway,21))\n(13,(Citi Field,156))\n(13,(Arthur Ashe Stadium,57))\n(13,(Billie Jean King National Tennis Center,30))\n(14,(Mitsuwa Marketplace,33))\n(14,(Vince Lombardi Service Area,24))\n(14,(Panera Bread,14))\n(15,(Starbucks,27))\n(15,(AMC Clifton Commons 16,20))\n(15,(Signature Fitness,18))\n(16,(Apple Store, West 14th Street,252))\n(16,(The High Line,207))\n(16,(The Chelsea Market,171))\n(17,(Holland Tunnel,144))\n(17,(Starbucks,89))\n(17,(Hoboken Terminal,55))\n(18,(Starbucks #07897,34))\n(18,(Kingdom of Legions and Ninjas,17))\n(18,(Fruit Ranch,16))\n(19,(Times Square,1084))\n(19,(Madison Square Garden,426))\n(19,(Bryant Park,363))\n(20,(South Mountain Yoga,16))\n(20,(Seton Hall University,9))\n(20,(McDonald\u0027s,4))\n(21,(Myrtle—Wycoff Avenues Station,41))\n(21,(Roberta\u0027s,28))\n(21,(292 Park,19))\n(22,(Newark Penn Station,234))\n(22,(Redwood Hall,51))\n(22,(Prudential Center,49))\n(23,(Bronx VA Hospital,35))\n(23,(The Cloisters,30))\n(23,(2020 Grand Ave,28))\n(24,(New Rochelle Station,21))\n(24,(Pelham Metro-North Station,12))\n(24,(X Haus,11))\n(25,(Brooklyn Bowl,80))\n(25,(The Bagel Store,55))\n(25,(McCarren Park,54))\n(26,(Staten Island Ferry,97))\n(26,(Middle Of The Harbor,19))\n(26,(Richmond County Bank Ballpark,11))\n(27,(Bay Plaza,27))\n(27,(Pelham Bay Park,24))\n(27,(3555 Bruckner Blvd,16))\n(28,(Garden State Plaza,65))\n(28,(AMC Garden State 16,27))\n(28,(Apple Store, Paramus,25))\n(29,(Apple Store, Staten Island,54))\n(29,(Staten Island Mall,23))\n(29,(Starbucks,8))\n(30,(The Bronx Zoo,45))\n(30,(New York Botanical Garden,25))\n(30,(Fordham Metro-North Station,19))\n(31,(Hillcrest Firehouse: PFD,15))\n(31,(La Ziza,12))\n(31,(Old Roberto Clemente,12))\n(32,(New Meadowlands Stadium,66))\n(32,(Izod Center,32))\n(32,(Station Square,27))\n(33,(Apple Store, SoHo,223))\n(33,(Starbucks Coffee,216))\n(33,(VaynerMedia HQ,211))\n(34,(Milk Bar,62))\n(34,(Bagel World,58))\n(34,(Union Street Station,54))\n(35,(Grand Central Terminal,1002))\n(35,(The Museum of Modern Art (MoMA),392))\n(35,(Rockefeller Center,353))\n(36,(LGA LaGuardia Airport,1673))\n(36,(Terminal C at LGA,131))\n(36,(LGA Marine Air Terminal,63))\n(37,(Statue of Liberty,124))\n(37,(Journal Square PATH Station,79))\n(37,(Ellis Island,44))\n(38,(Starbucks,176))\n(38,(Carlos And Kelseys Place,65))\n(38,(Whitney Museum of Art,64))\n(39,(Staten Island Zoo,19))\n(39,(Burrito Bar,19))\n(39,(Starbucks Coffee,17))\n(40,(Target,12))\n(40,(Home Sweet Home,12))\n(40,(Kings Plaza,8))\n(41,(Queens Center Mall,25))\n(41,(61st Street—Woodside Station,24))\n(41,(SriPraPhai,22))\n(42,(Retro Fitness,57))\n(42,(Riverside Square Mall,23))\n(42,(Bergen County Academies,13))\n(43,(Target,21))\n(43,(Applebee\u0027s,10))\n(43,(Cheeburger Cheeburger,8))\n(44,(Yankee Stadium,370))\n(44,(George Washington Bridge,184))\n(44,(625 W 156 Street,64))\n(45,(World Trade Center (Ground Zero),165))\n(45,(Battery Park,132))\n(45,(Starbucks Coffee,130))\n(46,(Coney Island Boardwalk,71))\n(46,(Nathan\u0027s Famous Frankfurters,53))\n(46,(New York Aquarium,22))\n(47,(Empire State Building,389))\n(47,(Union Square,333))\n(47,(Ace Hotel,277))\n(48,(Jamaica LIRR Station,124))\n(48,(Jamaica Airtrain,26))\n(48,(DEP 24,13))\n(49,(MTA Beach 67 St [A],19))\n(49,(Beach 67th,11))\n(49,(Delta Sky Club,10))\n"
      },
      "dateCreated": "Jun 16, 2015 1:41:43 PM",
      "dateStarted": "Jul 9, 2015 12:25:46 AM",
      "dateFinished": "Jul 9, 2015 12:25:50 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1434541066637_-850759271",
      "id": "20150617-133746_2078567635",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT"
      },
      "dateCreated": "Jun 17, 2015 1:37:46 PM",
      "dateStarted": "Jun 18, 2015 10:17:48 AM",
      "dateFinished": "Jun 18, 2015 10:17:51 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Location Based Social Networks: Spark and Cassandra",
  "id": "2ARJB9DQS",
  "angularObjects": {
    "2B61C8SQA": [],
    "2B6HTFEQ8": [],
    "2B6BHH1FG": [],
    "2B7JE9TM6": [],
    "2B6QGJ96M": [],
    "2B8PRXHS7": [],
    "2B5T81SHC": [],
    "2B4T4ASAJ": [],
    "2B66NZZ1N": [],
    "2B8Q42JQN": [],
    "2B6WWQAW5": [],
    "2B51T4TB8": [],
    "2B7SHR1KF": []
  },
  "config": {
    "looknfeel": "default"
  },
  "info": {}
}